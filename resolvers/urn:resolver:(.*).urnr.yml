# URN for explain itself

# https://regex101.com/?regex=urn:resolver:(.*)
# urn_base: "urn:resolver:(.*)"
# urn_resolver_internal: true

# https://stats.uptimerobot.com/jYDZlFY8jq

_meta:
  spec:
    - https://github.com/EticaAI/urn-resolver
  examples:
    - in.urn: urn:resolver:ping
      out.iri: "{{ urnresolver }}/_/resolver/ping.php?{{ unixtime }}"
    # - in.urn: urn:resolver:ping
    #   out.iri: "{{ urnresolver_base.self }}/_/resolver/ping.php"
      # out.iri: "{{ base_iri }}/_/resolver/ping.php"

rules:
  - in:
      urn: "urn:resolver:(.*)"
    out:
      - iri: "_internal/index.php"
        lb_w: 100
        http_status: 302

  - in:
      urn: "urn:resolver:ping"
    out:
      - iri: "{{ urnresolver_base.self }}/_/resolver/pong.php"
        http_status: 302

  - in:
      urn: "urn:resolver:cron:run"
    out:
      - iri: "{{ urnresolver_base.self }}/_/resolver/cron.php"
        http_status: 302
